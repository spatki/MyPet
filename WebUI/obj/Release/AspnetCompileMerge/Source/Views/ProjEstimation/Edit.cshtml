@using ProcessAccelerator.WebUI
@model tbl_org_proj_estimationInput
@{
    Layout = null;
    var sizeCount = (Model.tbl_org_proj_estm_size != null && Model.tbl_org_proj_estm_size.Any() ? Model.tbl_org_proj_estm_size.Max(o => o.ID) : 0);
    var effSchCount = (Model.tbl_org_proj_estm_effort_schedule != null && Model.tbl_org_proj_estm_effort_schedule.Any() ? Model.tbl_org_proj_estm_effort_schedule.Max(o => o.ID) : 0);
    var prodCount = (Model.tbl_org_proj_estm_productivity != null && Model.tbl_org_proj_estm_productivity.Any() ? Model.tbl_org_proj_estm_productivity.Max(o => o.ID) : 0);
    var tdiCount = (Model.tbl_org_proj_estm_gsc != null && Model.tbl_org_proj_estm_gsc.Any() ? Model.tbl_org_proj_estm_gsc.Max(o => o.ID) : 0);
    var linkedskillCount = 0;
}
<form id="projEstimationForm" name="projEstimationForm" method="post" action="@Url.Action("Edit","ProjEstimation")">
    <input type="hidden" id="ID" name="ID" value="@Model.ID" />
    <input type="hidden" id="ClientID" name="ClientID" value="@Model.ClientID" />
    <input type="hidden" id="tbl_Org_ProjectID" name="tbl_Org_ProjectID" value="@Model.tbl_Org_ProjectID"/>
    <input type="hidden" id="ProjectType" name="ProjectType" value="@Model.ProjectType"/>
    <input type="hidden" id="VersionInput" name="Version" value="@Model.Version"/>
    <input type="hidden" id="CurrentVersion" name="CurrentVersion" value="@Model.CurrentVersion.ToString()"/>
    <input type="hidden" id="CreatedOn" name="CreatedOn" value="@Model.CreatedOn"/>
    <input type="hidden" id="CostInput" name="Cost" value="@Model.Cost"/>
    <input type="hidden" id="SizeInput" name="Size" value="@Model.Size"/>
    <input type="hidden" id="SimpleEffortsInput" name="SimpleEfforts" value="@Model.SimpleEfforts"/>
    <input type="hidden" id="MediumEffortsInput" name="MediumEfforts" value="@Model.MediumEfforts"/>
    <input type="hidden" id="ComplexEffortsInput" name="ComplexEfforts" value="@Model.ComplexEfforts"/>
    <input type="hidden" id="TotalEffortsInput" name="TotalEfforts" value="@Model.TotalEfforts"/>
    <input type="hidden" id="ScheduleMonthsInput" name="ScheduleMonths" value="@Model.ScheduleMonths"/>
    <input type="hidden" id="TDIInput" name="TDI" value="@Model.TDI"/>
    <input type="hidden" id="VAFInput" name="VAF" value="@Model.VAF"/>
    <input type="hidden" id="CUT_Effort_PDsInput" name="CUT_Effort_PDs" value="@Model.CUT_Effort_PDs"/>
    <input type="hidden" id="CUT_Effort_FPsInput" name="CUT_Effort_FPs" value="@Model.CUT_Effort_FPs"/>
    <input type="hidden" id="CUT_TeamSizeInput" name="CUT_TeamSize" value="@Model.CUT_TeamSize"/>
    <input type="hidden" id="Team_ProductivityInput" name="Team_Productivity" value="@Model.Team_Productivity"/>
    <input type="hidden" id="TotalDefectsInput" name="TotalDefects" value="@Model.TotalDefects"/>
    <input type="hidden" id="TotalCutDefectsInput" name="TotalCutDefects" value="@Model.TotalCutDefects"/> <!-- **** This field is not required. Review and remove **** -->
    <input type="hidden" id="Overall_Project_PDsInput" name="Overall_Project_PDs" value="@Model.Overall_Project_PDs"/>
    <input type="hidden" id="newVersion" name="newVersion" value="@Model.newVersion.ToString()"/>
    @Html.ValidationSummary(false)  
    <div class="row">
        <div class="col-md-12"  id="fixHeader">
            <div class="col-md-12">
                <div class="col-md-3 pull-left">
                    <div class="col-md-6"><a href="Javascript:;" class="openDialog" title="Click to view previous cycles" data-source="@Url.Action("ShowPreviousCycles","ProjEstimation",new { id = Model.tbl_Org_ProjectID })" data-id="listing">Estimation Cycle</a></div>
                    <div class="col-md-6" id="Version">@Model.Version</div>
                </div>
                <div class="col-md-4">
                    <div class="col-md-4 pull-left">SDLC Phase</div>
                    <div class="col-md-8" >
                        @Html.Action("getListItemsFor", "OrgPhaseInProj", new { selectedItem = Model.tbl_Org_Proj_PhaseID, controlName = "tbl_Org_Proj_PhaseID", excludeIds = "", selectIds = "", projectTypeID = Model.ProjectType, reload = "" })
                        @Html.ValidationMessageFor(o => o.tbl_Org_Proj_PhaseID)
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="pull-right">
                        <div class="form-group">
                            <a href="Javascript:;" class="btn blue-bg save" data-form="projEstimationForm" data-id="listing" data-mode="update" id="NewTask">Save</a>
                            <a href="Javascript:;" class="btn blue-bg" id="newCycle" data-form="projEstimationForm" data-id="listing" data-source="@Url.Action("CreateCycle","ProjEstimation")">Create New Cycle</a>
                        </div>
                    </div>
                </div>
            </div>
            <table class="table table-bordered filterParams">
                <tbody>
                    <tr>
                        <th class="docTableLabel-bg columnMediumWidth">Size (FP)</th>
                        <td id="Size" class="updateInput columnMediumWidth">@Model.Size</td>
                        <th class="docTableLabel-bg columnMediumWidth">Efforts (Pers-Days)</th>
                        <td id="Overall_Project_PDs" class="updateInput columnMediumWidth">@Model.Overall_Project_PDs</td>
                        <th class="docTableLabel-bg columnMediumWidth">Project Cost (INR)</th>
                        <td id="Cost" class="updateInput columnMediumWidth">@Model.Cost</td>
                        <th class="docTableLabel-bg columnMediumWidth">Estimated Defects</th>
                        <td id="TotalDefects" class="updateInput columnMediumWidth">@Model.TotalDefects</td>
                    </tr>
                    <tr>
                        <th class="docTableLabel-bg columnMediumWidth">CUT Effort % of Total Effort</th>
                        <td >
                            <input type="text" value="@(Model.CUT_EffortPercent == 0 ? 65 : Model.CUT_EffortPercent) " id="CUT_EffortPercent" name="CUT_EffortPercent" size="4" class="RecalculateEstm"/>
                            @Html.ValidationMessageFor(o => o.CUT_EffortPercent)
                        </td>
                        <th class="docTableLabel-bg columnMediumWidth">Schedule (Months)</th>
                        <td id="ScheduleMonths" class="updateInput columnMediumWidth">@Model.ScheduleMonths</td>
                        <th class="docTableLabel-bg columnMediumWidth">PM SBR</th>
                        <td class="columnMediumWidth">
                            <input id="PMSBR" name="PMSBR" value="@Model.PMSBR" type="text"  class="RecalculateEstm"/>
                            @Html.ValidationMessageFor(o => o.PMSBR)
                        </td>
                        <th class="docTableLabel-bg columnMediumWidth">Defect Density</th>
                        <td class="columnMediumWidth">
                            <input type="text" id="DefectDensity" name="DefectDensity" size="4" value="@Model.DefectDensity"  class="RecalculateEstm"/> Per FP
                            <br />
                            @Html.ValidationMessageFor(o => o.DefectDensity)
                        </td>
                    </tr>             
                </tbody>
            </table>
        </div>
    </div>
    <div class="row">
        <div class="panel colored">
            <div class="panel-body">
                <ul class="nav nav-tabs" id="myTab">
                    <li class="active"><a data-toggle="tab" href="#sizeEstimate">Size Estimate</a></li>
                    <li><a data-toggle="tab" href="#valAdjment">Value Adjustment Factor</a></li>
                    <li><a data-toggle="tab" href="#teamProd">CUT Team Productivity</a></li>
                    <li><a data-toggle="tab" href="#effEstimate">Effort/Cost Estimate</a></li>
                    <li><a data-toggle="tab" href="#schEstimate">Schedule Estimate</a></li>
                    <li><a data-toggle="tab" href="#defEstimate">Defect Estimate</a></li>
                </ul>
                        
                <div class="tab-content" id="myTabContent">
                    <div id="sizeEstimate" class="tab-pane fade in active">
                        <br />
                        <div class="row">
                            <div class="col-md-12">
                                <table class="table table-bordered filterParams pull-right">
                                    <tr>
                                        <th rowspan="2" class="docTableHeader-bg">Normalised Points</th>
                                        <th class="docTableLabel-bg">Simple</th>
                                        <td id="SimpleEfforts" class="TableHighlight updateInput">@Model.SimpleEfforts</td>
                                        <th class="docTableLabel-bg updateInput">Medium</th>
                                        <td id="MediumEfforts" class="TableHighlight updateInput">@Model.MediumEfforts</td>
                                        <th class="docTableLabel-bg">Complex</th>
                                        <td id="ComplexEfforts" class="TableHighlight updateInput">@Model.ComplexEfforts</td>
                                        <th class="docTableLabel-bg">Total</th>
                                        <td id="TotalEfforts" class="TableHighlight updateInput">@Model.TotalEfforts</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="row col-lg-12">
                            <div class="col-lg-12 column left" data-keycount="@(sizeCount + 1)" id="sizeEstmParams">
                                <ul class="tree" id="DefaultNode" data-modules="0">
                                    @if (Model.proj_estm_group != null && Model.proj_estm_group.Any())
                                    {
                                        foreach (var grp in Model.proj_estm_group)
                                        {
                                            <li id="LG@(grp.GroupID)">
                                                <a href="Javascript:;" class="editLineItem" data-source="@Url.Action("EditModuleForEstm", "ProjGroup", new { ProjectID = Model.tbl_Org_ProjectID, EstmID = Model.ID, GroupID = grp.GroupID })" 
                                                    id="@grp.GroupID" data-params="sizeEstmParams" data-duplicate="checkmodule" data-id="@(grp.GroupID)"><i class="icon-edit"></i></a>
                                                <a class="tree-toggle checkmodule" data-toggle="branch" role="branch" data-id="@grp.GroupID" id="G@(grp.GroupID)" href="Javascript:;">@grp.Name</a>
                                                <ul id="CLG@(grp.GroupID)" class="branch in">
                                                    <li>
                                                        <table class="table table-bordered">
                                                            <thead>
                                                                <tr>
                                                                    <th class="docTableLabel-bg" rowspan="2"></th>
                                                                    <th class="docTableLabel-bg" rowspan="2">Parameters For Development</th>
                                                                    <th class="docTableLabel-bg" colspan="3">Count (Numbers)</th>
                                                                    <th class="docTableLabel-bg" colspan="3">Weightage</th>
                                                                    <th class="docTableLabel-bg" colspan="3">Weighted Points</th>
                                                                </tr>
                                                                <tr>
                                                                    <th class="docTableLabel-bg">S</th>
                                                                    <th class="docTableLabel-bg">M</th>
                                                                    <th class="docTableLabel-bg">C</th>
                                                                    <th class="docTableLabel-bg">S</th>
                                                                    <th class="docTableLabel-bg">M</th>
                                                                    <th class="docTableLabel-bg">C</th>
                                                                    <th class="docTableLabel-bg">S</th>
                                                                    <th class="docTableLabel-bg">M</th>
                                                                    <th class="docTableLabel-bg">C</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                @foreach (var sz in Model.tbl_org_proj_estm_size.Where(o => o.ProjGroupID == grp.GroupID))
                                                                {
                                                                    <tr id="P@(sz.ID)" class="checksize EditRow" data-id="@sz.ParameterID">
                                                                        <td><a href="Javascript:;" class="confirmAction" data-id="P@(sz.ID)" data-messagetitle="Confirm Action" data-message="Do you want to remove this parameter ?"
                                                                            data-class="removeLineItem" data-classparams="data-id='P@(sz.ID)'" data-source="">
                                                                            <i class="icon-remove"></i></a>
                                                                            <input type="hidden" id="tbl_org_proj_estm_size.Index" name="tbl_org_proj_estm_size.Index" value="@sz.ID" />
                                                                            <input type="hidden" id="tbl_org_proj_estm_size[@(sz.ID)].ID" name="tbl_org_proj_estm_size[@(sz.ID)].ID" value="@sz.ID" />
                                                                            <input type="hidden" id="tbl_org_proj_estm_size[@(sz.ID)].ClientID" name="tbl_org_proj_estm_size[@(sz.ID)].ClientID" value="@sz.ClientID" />
                                                                            <input type="hidden" id="tbl_org_proj_estm_size[@(sz.ID)].tbl_Org_ProjectID" name="tbl_org_proj_estm_size[@(sz.ID)].tbl_Org_ProjectID" value="@sz.tbl_Org_ProjectID" />
                                                                            <input type="hidden" id="tbl_org_proj_estm_size[@(sz.ID)].tbl_Proj_EstimationID" name="tbl_org_proj_estm_size[@(sz.ID)].tbl_Proj_EstimationID" value="@sz.tbl_Proj_EstimationID" />
                                                                            <input type="hidden" id="tbl_org_proj_estm_size[@(sz.ID)].ParameterID" name="tbl_org_proj_estm_size[@(sz.ID)].ParameterID" value="@sz.ParameterID" />
                                                                            <input type="hidden" id="ProjGroupID@(sz.ID)" name="tbl_org_proj_estm_size[@(sz.ID)].ProjGroupID" class="group" value="@sz.ProjGroupID" />
                                                                            <input type="hidden" id="@(sz.ID)SWInput" name="tbl_org_proj_estm_size[@(sz.ID)].SimpleW" value="@sz.SimpleW" />
                                                                            <input type="hidden" id="@(sz.ID)MWInput" name="tbl_org_proj_estm_size[@(sz.ID)].MediumW" value="@sz.MediumW" />
                                                                            <input type="hidden" id="@(sz.ID)CWInput" name="tbl_org_proj_estm_size[@(sz.ID)].ComplexW" value="@sz.ComplexW" />
                                                                            <input type="hidden" id="@(sz.ID)SInput" name="tbl_org_proj_estm_size[@(sz.ID)].SimpleC" value="@sz.SimpleC" />
                                                                            <input type="hidden" id="@(sz.ID)MInput" name="tbl_org_proj_estm_size[@(sz.ID)].MediumC" value="@sz.MediumC" />
                                                                            <input type="hidden" id="@(sz.ID)CInput" name="tbl_org_proj_estm_size[@(sz.ID)].ComplexC" value="@sz.ComplexC" />
                                                                            <input type="hidden" id="@(sz.ID)SWPInput" name="tbl_org_proj_estm_size[@(sz.ID)].SimpleWP" value="@sz.SimpleWP" />
                                                                            <input type="hidden" id="@(sz.ID)MWPInput" name="tbl_org_proj_estm_size[@(sz.ID)].MediumWP" value="@sz.MediumWP" />
                                                                            <input type="hidden" id="@(sz.ID)CWPInput" name="tbl_org_proj_estm_size[@(sz.ID)].ComplexWP" value="@sz.ComplexWP" />
                                                                        </td>
                                                                        <td>@sz.tbl_org_estm_parameters.Name</td>
                                                                        <td id="@(sz.ID)S" class="EditNumber updateInput FP" data-id="@(Model.ID)SInput" data-type="simple" data-navkey="EditNumber">@sz.SimpleC</td>
                                                                        <td id="@(sz.ID)M" class="EditNumber updateInput FP" data-id="@(Model.ID)MInput" data-type="medium" data-navkey="EditNumber">@sz.MediumC</td>
                                                                        <td id="@(sz.ID)C" class="EditNumber updateInput FP" data-id="@(Model.ID)CInput" data-type="complex" data-navkey="EditNumber">@sz.ComplexC</td>
                                                                        <td id="@(sz.ID)SW" class="EditNumber updateInput" data-id="@(Model.ID)SWInput" data-navkey="EditNumber">@sz.SimpleW</td>
                                                                        <td id="@(sz.ID)MW" class="EditNumber updateInput" data-id="@(Model.ID)MWInput" data-navkey="EditNumber">@sz.MediumW</td>
                                                                        <td id="@(sz.ID)CW" class="EditNumber updateInput" data-id="@(Model.ID)CWInput" data-navkey="EditNumber">@sz.ComplexW</td>
                                                                        <td id="@(sz.ID)SWP" class="simpleW TableDisabledLabel updateInput">@sz.SimpleWP</td>
                                                                        <td id="@(sz.ID)MWP" class="mediumW TableDisabledLabel updateInput">@sz.MediumWP</td>
                                                                        <td id="@(sz.ID)CWP" class="complexW TableDisabledLabel updateInput">@sz.ComplexWP</td>
                                                                    </tr>
                                                                }
                                                                <tr id="NewParameter" class="addNewOption">
                                                                    <td>
                                                                        <a href="Javascript:;" class="addLineItem" data-source="@Url.Action("AddParameter", "ProjEstimation", new { ProjectID = Model.tbl_Org_ProjectID, EstmID = Model.ID })" 
                                                                            data-id="G@(grp.GroupID)New" data-params="sizeEstmParams" data-duplicate="checksize" data-type="parameter"><i class="icon-plus"></i></a>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </li>
                                                </ul>
                                            </li>
                                        }
                                    }
                                    <li id="NewModule" class="addNewOption">
                                        <a href="Javascript:" class="addLineItem" data-id="NewModule" id="newModuleLink"
                                            data-source="@Url.Action("AddNewModuleForEstm","ProjGroup", new { ProjectID = Model.tbl_Org_ProjectID, EstmID = Model.ID })" 
                                            data-params="sizeEstmParams" data-duplicate="checkmodule">Add Module</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div id="valAdjment" class="tab-pane">
                        <br />
                        <div class="row">
                            <div class="col-md-12">
                                <table class="table table-bordered filterParams pull-right">
                                    <tr>
                                        <th class="docTableLabel-bg">Total Degree of Influence (TDI)</th>
                                        <td id="TDI" class="TableHighlight updateInput">@Model.TDI</td>
                                        <th class="docTableLabel-bg">VAF = 0.65 + (TDI * 0.01)</th>
                                        <td id="VAF" class="TableHighlight updateInput">@Model.VAF</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="row">
                            <table  class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th class="tblActionIcon"></th> 
                                        <th class="EstGSCTitle">General Systems Characteristics (GSC)</th>
                                        <th class="TSHours">Degree of Influence (0-5)</th>
                                        <th >Interpretation</th>
                                    </tr>
                                </thead>
                                <tbody data-keycount="@(tdiCount + 1)" id="TDIParams" data-message="GSC Added">
                                        @foreach (var tdi in Model.tbl_org_estm_gsc_master)
                                        {
                                            var tdiDetails = Model.tbl_org_proj_estm_gsc.Where(o => o.tbl_Org_Estm_TDI_ID == tdi.ID).SingleOrDefault();
                                            if (tdiDetails == null) { tdiCount = tdiCount + 1; }
                                            <tr class="EditRow checkGSC" data-id="@tdi.ID" id="GSC@(tdi.ID)">
                                                <td>
                                                    <input type="hidden" id="tbl_org_proj_estm_gsc.Index" name="tbl_org_proj_estm_gsc.Index" value="@(tdiDetails == null ? tdiCount : tdiDetails.ID)" />
                                                    <input type="hidden" id="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].ID" name="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].ID" value="@(tdiDetails == null ? tdiCount : tdiDetails.ID)" />
                                                    <input type="hidden" id="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].ClientID" name="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].ClientID" value="@Model.ClientID" />
                                                    <input type="hidden" id="GSCRating@(tdiDetails == null ? tdiCount : tdiDetails.ID)Input" name="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].Rating" value="@(tdiDetails == null ? 0 : tdiDetails.Rating)" />
                                                    <input type="hidden" id="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].tbl_Org_ProjectID" name="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].tbl_Org_ProjectID" value="@Model.tbl_Org_ProjectID" />
                                                    <input type="hidden" id="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].tbl_Proj_EstimationID" name="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].tbl_Proj_EstimationID" value="@Model.ID" />
                                                    <input type="hidden" id="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].tbl_Org_Estm_TDI_ID" name="tbl_org_proj_estm_gsc[@(tdiDetails == null ? tdiCount : tdiDetails.ID)].tbl_Org_Estm_TDI_ID" value="@tdi.ID" />
                                                </td>
                                                <td>@tdi.Name</td>
                                                <td class="EditGSC GSCRating updateInput" data-navkey="EditGSC" id="GSCRating@(tdiDetails == null ? tdiCount : tdiDetails.ID)">@(tdiDetails == null ? 0 : tdiDetails.Rating)</td>
                                                <td ><div class="col-md-12">@Html.Raw(tdi.HelpText)</div></td>
                                            </tr>                                 
                                        }
                                    <!-- tr id="NewGSC"  class="addNewOption">
                                        <td><a href="Javascript:;" class="addLineItem" data-source="@Url.Action("AddGSC","ProjEstimation", new { ProjectID = Model.tbl_Org_ProjectID, EstmID = Model.ID })" 
                                            data-id="GSCNew" data-params="TDIParams" data-duplicate="checkGSC" title="Add GSC"><i class="icon-">&#xf055</i></a></td>
                                    </!-->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div id="teamProd" class="tab-pane">
                        <br />
                        <div class="row">
                            <div class="col-md-12">
                                <table class="table table-bordered filterParams pull-right">
                                    <tr>
                                        <th class="docTableLabel-bg">CUT Team Size</th>
                                        <td id="CUT_TeamSize" class="TableHighlight updateInput">@Model.CUT_TeamSize</td>
                                        <th class="docTableLabel-bg">Team Productivity</th>
                                        <td id="Team_Productivity" class="TableHighlight updateInput">@Model.Team_Productivity</td>
                                        <th class="docTableLabel-bg">Size in FP for Cut (with VAF)</th>
                                        <td id="CUT_Effort_FPs" class="TableHighlight updateInput">@Model.CUT_Effort_FPs</td>
                                        <th class="docTableLabel-bg">CUT Effort in Person-days</th>
                                        <td id="CUT_Effort_PDs" class="TableHighlight updateInput">@Model.CUT_Effort_PDs</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="row">
                            <table  class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>Role</th>
                                        <th>Number</th>
                                        <th>FP / day</th>
                                        <th>% Assigned</th>
                                    </tr>
                                </thead>
                                <tbody data-keycount="@(prodCount + 1)" id="ProdParams" data-message="CUT Team Role Added">
                                    @if (Model.tbl_org_proj_estm_productivity != null)
                                    {
                                        foreach (var rl in Model.tbl_org_proj_estm_productivity)
                                        {
                                            <tr id="Prod@(rl.ID)" class="EditRow checkTeamRole" data-id="@rl.tbl_Org_RoleID">
                                                <td><a href="Javascript:;" class="confirmAction" data-id="Prod@(rl.ID)" data-messagetitle="Confirm Action" data-message="Do you want to remove this role ?"
                                                    data-class="removeLineItem" data-classparams="data-id='Prod@(rl.ID)'" data-source="">
                                                    <i class="icon-remove"></i></a>
                                                    <input type="hidden" id="tbl_org_proj_estm_productivity.Index" name="tbl_org_proj_estm_productivity.Index" value="@rl.ID" />
                                                    <input type="hidden" id="tbl_org_proj_estm_productivity[@(rl.ID)].ID" name="tbl_org_proj_estm_productivity[@(rl.ID)].ID" value="@rl.ID" />
                                                    <input type="hidden" id="tbl_org_proj_estm_productivity[@(rl.ID)].ClientID" name="tbl_org_proj_estm_productivity[@(rl.ID)].ClientID" value="@rl.ClientID" />
                                                    <input type="hidden" id="Prod@(rl.ID)ResourceCountFPInput" name="tbl_org_proj_estm_productivity[@(rl.ID)].FP_Per_Day" value="@rl.FP_Per_Day" />
                                                    <input type="hidden" id="Prod@(rl.ID)ResourceCountPCInput" name="tbl_org_proj_estm_productivity[@(rl.ID)].PercentAllocation" value="@rl.PercentAllocation" />
                                                    <input type="hidden" id="Prod@(rl.ID)ResourceCountInput" name="tbl_org_proj_estm_productivity[@(rl.ID)].ResourceCount" value="@rl.ResourceCount" />
                                                    <input type="hidden" id="Prod@(rl.ID)tbl_Org_ProjectIDInput" name="tbl_org_proj_estm_productivity[@(rl.ID)].tbl_Org_ProjectID" value="@rl.tbl_Org_ProjectID" />
                                                    <input type="hidden" id="Prod@(rl.ID)tbl_Proj_EstimationIDInput" name="tbl_org_proj_estm_productivity[@(rl.ID)].tbl_Proj_EstimationID" value="@rl.tbl_Proj_EstimationID" />
                                                    <input type="hidden" id="Prod@(rl.ID)tbl_Org_RoleIDInput" name="tbl_org_proj_estm_productivity[@(rl.ID)].tbl_Org_RoleID" value="@rl.tbl_Org_RoleID" />
                                                </td>
                                                <td>@rl.mstr_org_role.LongName</td>
                                                <td id="Prod@(rl.ID)ResourceCount" class="EditNumber teamProd updateInput" data-navkey="EditNumber">@rl.ResourceCount</td>
                                                <td id="Prod@(rl.ID)ResourceCountFP" class="EditNumber updateInput" data-navkey="EditNumber">@rl.FP_Per_Day</td>
                                                <td id="Prod@(rl.ID)ResourceCountPC" class="EditNumber updateInput" data-navkey="EditNumber">@rl.PercentAllocation</td>
                                            </tr>
                                        }
                                    }
                                    <tr id="NewTeamRole"  class="addNewOption">
                                        <td><a href="Javascript:;" class="addLineItem" data-source="@Url.Action("AddTeamRole","ProjEstimation", new { ProjectID = Model.tbl_Org_ProjectID, EstmID = Model.ID })" 
                                            data-id="NewTeamRole" data-params="ProdParams" data-duplicate="checkTeamRole" title="Add GSC"><i class="icon-">&#xf055</i></a></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div id="effEstimate" class="tab-pane">
                        <br />
                        <div class="row">
                            <table  class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>Phases</th>
                                        <th>Effort (%)</th>
                                        <th>Pers Days</th>
                                        <th>Role</th>
                                        <th>SBR</th>
                                        <th>PM Load</th>
                                        <th>PM Effort</th>
                                        <th>PM Cost</th>
                                        <th>Other Costs</th>
                                    </tr>
                                </thead>
                                <tbody data-keycount="@(effSchCount + 1)" id="PhaseParams" data-message="Phase Added">
                                    @if (Model.tbl_org_proj_estm_effort_schedule != null)
                                    {
                                        foreach (var ph in Model.tbl_org_proj_estm_effort_schedule)
                                        {
                                            <tr class="EditRow checkPhase" data-id="@ph.tbl_Org_PhaseID" id="Ph@(ph.ID)">
                                                <td><a href="Javascript:;" class="confirmAction" data-source=""
                                                        data-messagetitle="Confirm Action" data-message="Do you want to remove this Phase ?" data-id="Ph@(ph.ID)"
                                                        data-class="removeEstmPhase" data-classparams="data-id='Ph@(ph.ID)'" title="Remove this Phase"><i class="icon-remove"></i></a>
                                                        <input type="hidden" id="tbl_org_proj_estm_effort_schedule.Index" name="tbl_org_proj_estm_effort_schedule.Index" value="@ph.ID" />
                                                        <input type="hidden" id="tbl_org_proj_estm_effort_schedule[@(ph.ID)].ID" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].ID" value="@ph.ID" />
                                                        <input type="hidden" id="tbl_org_proj_estm_effort_schedule[@(ph.ID)].ClientID" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].ClientID" value="@ph.ClientID" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhaseInput" : "PPC" + ph.ID.ToString() + "Input")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].EffortPercent" value="@ph.EffortPercent" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhaseDefectsInput" : "PPC" + ph.ID.ToString() + "DefectsInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].Defects" value="@ph.Defects" />
                                                        <input type="hidden" id="tbl_org_proj_estm_effort_schedule[@(ph.ID)].IsCutPhase" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].IsCutPhase" value="@ph.IsCutPhase.ToString()" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhaseEffInput" : "PPC" + ph.ID.ToString() + "EffInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].PDs" value="@ph.PDs" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhaseSchPDInput" : "PPC" + ph.ID.ToString() + "SchPDInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].Sch_Days" value="@ph.Sch_Days" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhaseSchEndDtInput" : "PPC" + ph.ID.ToString() + "SchEndDtInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].Sch_EndDate" value="@(ph.Sch_EndDate == null ? "" : ph.Sch_EndDate.GetValueOrDefault().ToString(Globals.DateFormatString))" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhaseSchHolidayInput" : "PPC" + ph.ID.ToString() + "SchHolidayInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].Sch_Holidays" value="@ph.Sch_Holidays" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhaseSchPplInput" : "PPC" + ph.ID.ToString() + "SchPplInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].Sch_People" value="@ph.Sch_People" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhaseSchStDateInput" : "PPC" + ph.ID.ToString() + "SchStDateInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].Sch_StartDate" value="@(ph.Sch_StartDate == null ? "" : ph.Sch_StartDate.GetValueOrDefault().ToString(Globals.DateFormatString))" />
                                                        <input type="hidden" id="tbl_org_proj_estm_effort_schedule[@(ph.ID)].SequenceNo" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].SequenceNo" value="@ph.SequenceNo" />
                                                        <input type="hidden" id="tbl_org_proj_estm_effort_schedule[@(ph.ID)].tbl_Org_ProjectID" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].tbl_Org_ProjectID" value="@ph.tbl_Org_ProjectID" />
                                                        <input type="hidden" id="tbl_org_proj_estm_effort_schedule[@(ph.ID)].tbl_Proj_EstimationID" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].tbl_Proj_EstimationID" value="@ph.tbl_Proj_EstimationID" />
                                                        <input type="hidden" id="tbl_org_proj_estm_effort_schedule[@(ph.ID)].tbl_Org_PhaseID" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].tbl_Org_PhaseID" value="@ph.tbl_Org_PhaseID" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhaseSBRInput" : "PPC" + ph.ID + "SBRInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].SBR" value="@ph.SBR" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhasePMLoadInput" : "PPC" + ph.ID + "PMLoadInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].PM_Loading" value="@ph.PM_Loading" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhasePMEffortInput" : "PPC" + ph.ID + "PMEffortInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].PM_Effort" value="@ph.PM_Effort" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhasePMCostInput" : "PPC" + ph.ID + "PMCostInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].PM_Cost" value="@ph.PM_Cost" />
                                                        <input type="hidden" id="@(ph.IsCutPhase == true ? "CUT_PhaseOtherCostInput" : "PPC" + ph.ID + "OtherCostInput")" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].Other_Costs" value="@ph.Other_Costs" />
                                                </td>
                                                <td id="PPC@(ph.ID)Name" class="@(ph.IsCutPhase == true ? "TableDisabledLabel" : "")">@ph.mstr_org_proj_phase.LongName</td>
                                                <td class="@(ph.IsCutPhase == true ? "TableDisabledLabel" : "EditNumber") effSchEst updateInput" 
                                                    data-navkey="@(ph.IsCutPhase == true ? "" : "EditNumber")" data-class="@(ph.IsCutPhase == true ? "" : "EditNumber")" 
                                                    data-type="sch" id="@(ph.IsCutPhase == true ? "CUT_Phase" : "PPC" + ph.ID.ToString())">@ph.EffortPercent</td>
                                                <td class="TableDisabledLabel updateInput" id="@(ph.IsCutPhase == true ? "CUT_PhaseEff" : "PPC" + ph.ID.ToString() + "Eff")">@ph.PDs</td>
                                                <td id="Ph@(ph.ID)Role">
                                                    @if (ph.Roles == null || ph.Roles == "")
                                                    {
                                                        <a href="Javascript:;" class="addLineItem" data-source="@Url.Action("LinkRolesForCost","ProjEstimation", new {  ProjectID = Model.tbl_Org_ProjectID, EstmID = Model.ID, PhaseID = ph.ID, SelectedIDs = ph.RoleIDs } )" 
                                                            data-params="LinkedSkillParams" data-duplicate="checkLinkedSkills" title="Link Role(s)">Add Roles</a>
                                                        <input type="hidden" id="Ph@(ph.ID)RoleInput" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].Roles" value="" />
                                                        <input type="hidden" id="Ph@(ph.ID)RoleIDsInput" class="checkLinkedSkills" data-id="@ph.RoleIDs" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].RoleIDs" value="" />                                                    
                                                    }
                                                    else
                                                    {
                                                        linkedskillCount += ph.RoleIDs.Split(',').Count();
                                                        <a href="Javascript:;" class="addLineItem" data-source="@Url.Action("LinkRolesForCost","ProjEstimation", new {  ProjectID = Model.tbl_Org_ProjectID, EstmID = Model.ID, PhaseID = ph.ID, SelectedIDs = ph.RoleIDs } )" 
                                                            data-params="LinkedSkillParams" data-duplicate="checkLinkedSkills" title="Link Role(s)">@ph.Roles</a>
                                                        <input type="hidden" id="Ph@(ph.ID)RoleInput" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].Roles" value="@ph.Roles" />
                                                        <input type="hidden" id="Ph@(ph.ID)RoleIDsInput" name="tbl_org_proj_estm_effort_schedule[@(ph.ID)].RoleIDs" value="@ph.RoleIDs" />                                                    
                                                    }
                                                </td>
                                                <td class="EditNumber updateInput" data-navkey="EditNumber" id="@(ph.IsCutPhase == true ? "CUT_PhaseSBR" : "PPC" + ph.ID + "SBR")">@ph.SBR</td>
                                                <td class="EditNumber updateInput" data-navkey="EditNumber" id="@(ph.IsCutPhase == true ? "CUT_PhasePMLoad" : "PPC" + ph.ID + "PMLoad")">@ph.PM_Loading</td>
                                                <td class="TableDisabledLabel updateInput" id="@(ph.IsCutPhase == true ? "CUT_PhasePMEffort" : "PPC" + ph.ID + "PMEffort")">@ph.PM_Effort</td>
                                                <td id="@(ph.IsCutPhase == true ? "CUT_PhasePMCost" : "PPC" + ph.ID + "PMCost")" class="TableDisabledLabel updateInput">@ph.PM_Cost</td>
                                                <td id="@(ph.IsCutPhase == true ? "CUT_PhaseOtherCost" : "PPC" + ph.ID + "OtherCost")" class="TableDisabledLabel updateInput">@ph.Other_Costs</td>
                                            </tr>
                                        }
                                    }
                                    <tr class="addNewOption" id="LinkedSkillParams" data-keycount="@(linkedskillCount + 1)" data-message="Skill(s) linked">
                                        <td><a href="Javascript:;" class="addLineItem" data-source="@Url.Action("AddPhase","ProjEstimation", new { ProjectID = Model.tbl_Org_ProjectID, EstmID = Model.ID })" 
                                            data-params="PhaseParams" data-duplicate="checkPhase" title="Add Phase"><i class="icon-plus"></i></a></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <th >Total</th>
                                        <td class="TableDisabledLabel" id="PCTotal">@(Model.tbl_org_proj_estm_effort_schedule == null ? 0 : Model.tbl_org_proj_estm_effort_schedule.Sum(o => o.EffortPercent))</td>
                                        <td class="TableDisabledLabel" id="EffTotal">@(Model.tbl_org_proj_estm_effort_schedule == null ? 0 : Model.tbl_org_proj_estm_effort_schedule.Sum(d => d.PDs))</td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td class="TableDisabledLabel" id="PMCostTotal"></td>
                                        <td class="TableDisabledLabel" id="OtherCostTotal"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div id="schEstimate" class="tab-pane">
                        <br />
                        <div class="row">
                            <div class="col-md-12">
                                <table class="table table-bordered filterParams pull-right">
                                    <tr>
                                        <th class="docTableLabel-bg">Schedule Total Days</th>
                                        <td id="schDays">@(@Model.ScheduleMonths * 30)</td>
                                        <th class="docTableLabel-bg">Schedule Months</th>
                                        <td id="schMonths">@Model.ScheduleMonths</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="row">
                            <table  class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Phases</th>
                                        <th>Pers Days</th>
                                        <th>People</th>
                                        <th>Days</th>
                                        <th>Holiday</th>
                                        <th>Start Date</th>
                                        <th>End Date</th>
                                    </tr>
                                </thead>
                                <tbody id="ScheduleParams">
                                    @if (Model.tbl_org_proj_estm_effort_schedule != null)
                                    {
                                        foreach (var sch in Model.tbl_org_proj_estm_effort_schedule.OrderBy(o => o.SequenceNo))
                                        {
                                            <tr class="EditRow" id="Ph@(sch.ID)Sch">
                                                <td class="docTableLabel-bg">@sch.mstr_org_proj_phase.LongName</td>
                                                <td class="TableDisabledLabel updateInput" id="@(sch.IsCutPhase == true ? "CUT_PhaseEffForSch" : "PPC" + sch.ID.ToString() + "EffForSch")">@sch.PDs</td>
                                                <td class="EditNumber updateInput" data-navkey="EditNumber" data-type="projSch" id="@(sch.IsCutPhase == true ? "CUT_PhaseSchPpl" : "PPC" + sch.ID.ToString() + "SchPpl")">@sch.Sch_People</td>
                                                <td class="TableDisabledLabel updateInput" id="@(sch.IsCutPhase == true ? "CUT_PhaseSchPD" : "PPC" + sch.ID.ToString() + "SchPD")">@sch.Sch_Days</td>
                                                <td class="EditNumber updateInput" data-navkey="EditNumber" id="@(sch.IsCutPhase == true ? "CUT_PhaseSchHoliday" : "PPC" + sch.ID.ToString() + "SchHoliday")">@sch.Sch_Holidays</td>
                                                <td class="EditDate updateDate"  data-navkey="@(sch.SequenceNo == 1 ? "EditNumber" : "")" id="@(sch.IsCutPhase == true ? "CUT_PhaseSchStDate" : "PPC" + sch.ID.ToString() + "SchStDate")">@sch.Sch_StartDate.GetValueOrDefault().ToString(Globals.DateFormatString)</td>
                                                <td class="TableDisabledLabel updateDate" id="@(sch.IsCutPhase == true ? "CUT_PhaseSchEndDt" : "PPC" + sch.ID.ToString() + "SchEndDt")">@sch.Sch_EndDate.GetValueOrDefault().ToString(Globals.DateFormatString)</td>
                                            </tr>
                                        }
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div id="defEstimate" class="tab-pane">
                        <br />
                        <div class="row">
                            <table  class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Phases</th>
                                        <th>Efforts</th>
                                        <th>Defects</th>
                                    </tr>
                                </thead>
                                <tbody id="DefectParams">
                                    @if (Model.tbl_org_proj_estm_effort_schedule != null)
                                    {
                                        foreach (var def in Model.tbl_org_proj_estm_effort_schedule.OrderBy(o => o.SequenceNo))
                                        {
                                            <tr id="Ph@(def.ID)Defect">
                                                <td class="docTableLabel-bg">@def.mstr_org_proj_phase.LongName</td>
                                                <td class="TableDisabledLabel" id="@(def.IsCutPhase == true ? "CUT_PhaseEffForDef" : "PPC" + def.ID.ToString() + "EffForDef")">@def.PDs</td>
                                                <td class="TableDisabledLabel updateInput" id="@(def.IsCutPhase == true ? "CUT_PhaseDefects" : "PPC" + def.ID.ToString() + "Defects")">@def.Defects</td>
                                            </tr>
                                        }
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
